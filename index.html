<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chaguo - Internet Freedom for Tanzania</title>
    <meta name="description" content="Open-source toolkit to bypass internet restrictions in Tanzania">
    <meta name="theme-color" content="#2E7D32">

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üåê</text></svg>">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/chaguo-tanzania/manifest.json">
    
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    
    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs@gh-pages/qrcode.min.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            const swUrl = 'sw.js';
            
            navigator.serviceWorker.register(swUrl)
                .then(registration => {
                    console.log('‚úÖ Service Worker registered:', registration.scope);
                    
                    // Check for updates
                    registration.addEventListener('updatefound', () => {
                        console.log('üîÑ Service Worker update found');
                    });
                })
                .catch(error => {
                    console.log('‚ùå Service Worker registration failed:', error);
                });
        });
    }
    
    // PWA install prompt
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        console.log('üì± PWA install available');
        
        // Show install button after 3 seconds
        setTimeout(() => {
            const installBtn = document.getElementById('install-pwa');
            if (installBtn) {
                installBtn.style.display = 'block';
                installBtn.addEventListener('click', async () => {
                    if (deferredPrompt) {
                        deferredPrompt.prompt();
                        const { outcome } = await deferredPrompt.userChoice;
                        console.log(`User ${outcome} the install`);
                        deferredPrompt = null;
                    }
                });
            }
        }, 3000);
    });
    </script>
</head>
<body>
    <!-- Language Switcher -->
    <div class="language-switcher">
        <button id="lang-en" class="lang-btn active">English</button>
        <button id="lang-sw" class="lang-btn">Kiswahili</button>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <h1 id="title">Chaguo - Your Choice for Internet Freedom</h1>
            <p id="subtitle">Open-source tools to bypass internet restrictions in Tanzania</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <!-- QR Code Generator -->
        <section class="card qr-section">
            <h2>üì± One-Click Setup</h2>
            <p>Scan QR code to import configuration directly to your VPN client</p>
            
            <div class="qr-container">
                <div id="qrcode"></div>
                <div class="qr-controls">
                    <button id="generate-qr" class="btn primary">
                        üîÑ Generate New Config
                    </button>
                    <button id="download-qr" class="btn secondary">
                        üíæ Download QR Code
                    </button>
                </div>
                <div class="qr-info">
                    <p>Config expires in: <span id="expiry-time">24:00:00</span></p>
                    <p>Protocol: <span id="protocol-name">V2Ray + WebSocket</span></p>
                </div>
            </div>
            
            <!-- Manual Config -->
            <div class="manual-config">
                <h3>üìù Manual Configuration</h3>
                <textarea id="config-text" class="config-textarea" readonly></textarea>
                <button id="copy-config" class="btn secondary">üìã Copy Config</button>
                <button id="download-config" class="btn secondary">‚¨áÔ∏è Download Config</button>
            </div>
        </section>

        <!-- Download Section -->
        <section class="card">
            <h2>‚¨áÔ∏è Download Chaguo Toolkit</h2>
            <p>Available for all platforms</p>
            
            <div class="download-grid">
                <a href="desktop-app/" class="download-card">
                    <div class="download-icon">üíª</div>
                    <h3>Desktop App</h3>
                    <p>Windows, macOS, Linux</p>
                    <small>One-click connect</small>
                </a>
                
                <a href="https://github.com/cephasgm/chaguo-tanzania" class="download-card" target="_blank">
                    <div class="download-icon">üì±</div>
                    <h3>Mobile Configs</h3>
                    <p>Android & iOS</p>
                    <small>Import to your client</small>
                </a>
                
                <a href="#cli-tools" class="download-card">
                    <div class="download-icon">‚ö°</div>
                    <h3>CLI Tools</h3>
                    <p>For advanced users</p>
                    <small>Terminal-based</small>
                </a>
            </div>
        </section>

        <!-- Methods Section -->
        <section class="card">
            <h2>üõ°Ô∏è Working Methods</h2>
            <div id="methods-list" class="methods-grid">
                <div class="method-card">
                    <h4>V2Ray + WebSocket</h4>
                    <p>Uses WebSocket with TLS encryption to bypass DPI</p>
                    <small>Last tested: Today</small>
                </div>
                <div class="method-card">
                    <h4>Shadowsocks + Obfs</h4>
                    <p>Lightweight proxy with traffic obfuscation</p>
                    <small>Last tested: Today</small>
                </div>
                <div class="method-card">
                    <h4>WireGuard</h4>
                    <p>Modern VPN protocol with better performance</p>
                    <small>Last tested: Today</small>
                </div>
            </div>
        </section>

        <!-- Telegram Bot -->
        <section class="card telegram-section">
            <h2>ü§ñ Telegram Bot</h2>
            <p>Get latest configurations and updates via Telegram</p>
            <a href="https://t.me/chaguo_tz_bot" class="telegram-link" target="_blank">
                <div class="telegram-icon">‚úàÔ∏è</div>
                <div>
                    <h3>@chaguo_tz_bot</h3>
                    <p>Click to start conversation</p>
                </div>
            </a>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>¬© 2024 Chaguo Tanzania. MIT License.</p>
            <p>For educational purposes only.</p>
            <button id="install-pwa" style="display:none; margin-top:10px;" class="btn primary">üì≤ Install as App</button>
        </div>
    </footer>

    <!-- Main App Script -->
    <script src="app.js"></script>
</body>
</html>
